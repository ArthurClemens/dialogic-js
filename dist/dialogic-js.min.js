"use strict";(()=>{var q=Object.defineProperty,U=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var C=(e,t,n)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,l=(e,t)=>{for(var n in t||(t={}))K.call(t,n)&&C(e,n,t[n]);if(A)for(var n of A(t))B.call(t,n)&&C(e,n,t[n]);return e},g=(e,t)=>U(e,W(t));var w=e=>new Promise(t=>setTimeout(t,e)),J=(e,t)=>t.reduce((n,a)=>n!=="0s"?n:e.getPropertyValue(a),"0s"),P=({domElement:e,props:t})=>{let n=document.defaultView;if(n){let a=n.getComputedStyle(e);if(a)return J(a,t)}},v=e=>{let t=parseFloat(e)*(e.indexOf("ms")===-1?1e3:1);return Number.isNaN(t)?0:t},h=e=>{let t=P({domElement:e,props:["animation-duration","transition-duration"]}),n=t!==void 0?v(t):0,a=P({domElement:e,props:["animation-delay","transition-delay"]}),s=a!==void 0?v(a):0;return n+s},I=e=>e.scrollTop,_=e=>{let t=typeof window<"u"?window.getComputedStyle(e):{};return t.opacity==="0"||t.display==="none"?!1:!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},$=(e,t)=>e instanceof HTMLAnchorElement&&e.rel!=="ignore"||e instanceof HTMLAreaElement&&e.href!==void 0||[HTMLInputElement,HTMLSelectElement,HTMLTextAreaElement,HTMLButtonElement].some(n=>e instanceof n)&&!e.disabled||e instanceof HTMLIFrameElement||e.tabIndex>0||!t&&e.tabIndex===0&&e.getAttribute("tabindex")!==null&&e.getAttribute("aria-hidden")!=="true",x=e=>[].slice.call(e.querySelectorAll("button, [href], input, select, textarea, [tabindex]:not([tabindex='-1'])")).filter(n=>$(n,!0)).sort((n,a)=>n.tabIndex-a.tabIndex)[0],F=(e,t,n)=>{t&&(e[t]||(e[t]=JSON.stringify(n)))},k=(e,t)=>{if(t)return JSON.parse(e[t])},b=(e,t)=>{t&&delete e[t]},N=(e,t)=>{!t||!e||Object.keys(e).forEach(n=>{t.dataset[n]=e[n]})};var V="[data-prompt]",j="[data-content]",z="[data-touch]",Q="[data-toggle]",X="ismodal",Y="isescapable",Z="isfocusfirst",ee="focusfirst",D="isopen",G="isshowing",R="ishiding",S="islocked",te=300,y={isOpen:!1,willShow:!1,didShow:!1,willHide:!1,didHide:!1},M=async(e,t={})=>{var u,p,m,f;let{prompt:n,content:a,root:s,isDetails:i,isEscapable:d,escapeListener:c}=e;if(s.dataset[S]!==void 0&&!t.isIgnoreLockDuration)return;n.status=g(l({},y),{isOpen:!0,willHide:!0}),(u=t.willHide)==null||u.call(t,e),(p=t.getStatus)==null||p.call(t,n.status),delete s.dataset[G],s.dataset[R]="";let E=h(a);await w(E),i&&s.removeAttribute("open"),delete s.dataset[R],delete s.dataset[D],n.status=g(l({},y),{didHide:!0}),(m=t.getStatus)==null||m.call(t,n.status),(f=t.didHide)==null||f.call(t,e),d&&typeof window<"u"&&window.removeEventListener("keydown",c)},H=async(e,t={})=>{var m,f,r,o;let{prompt:n,content:a,root:s,isDetails:i,isEscapable:d,isFocusFirst:c,focusFirstSelector:E,escapeListener:u}=e;if(s.dataset[S]!==void 0)return;s.dataset[S]="",setTimeout(()=>{s&&delete s.dataset[S]},te),d&&typeof window<"u"&&window.addEventListener("keydown",u),i&&s.setAttribute("open",""),s.dataset[D]="",I(s),s.dataset[G]="",n.status=g(l({},y),{willShow:!0}),(m=t.willShow)==null||m.call(t,e),console.log("options.getStatus",t.getStatus),(f=t.getStatus)==null||f.call(t,n.status);let p=h(a);if(await w(p),c){let T=x(a);T&&T.focus()}else if(E){let T=a.querySelector(E);T&&T.focus()}n.status=g(l({},y),{didShow:!0,isOpen:!0}),(r=t.didShow)==null||r.call(t,e),(o=t.getStatus)==null||o.call(t,n.status)},O=async(e,t=2,n)=>{switch(t){case 0:return await H(e,n);case 1:return await M(e,n);default:return _(e.content)?await M(e,n):await H(e,n)}},ne=(e,t,n,a)=>{let s=null;if(!n&&t?s=t:typeof n=="string"?s=document.querySelector(n):n&&n.tagName&&(s=n.closest(V)),!s){console.error("Prompt element 'data-root' not found");return}let i=s.querySelector(j);if(!i){console.error("Prompt element 'data-content' not found");return}let d=s.querySelector(Q)||s.querySelector("summary"),c=s.querySelector(z),E=s.tagName==="DETAILS",u=s.dataset[X]!==void 0,p=s.dataset[Y]!==void 0,m=s.dataset[Z]!==void 0,f=s.dataset[ee],r={prompt:e,root:s,isDetails:E,isModal:u,isEscapable:p,isFocusFirst:m,focusFirstSelector:f,toggle:d,content:i,touchLayer:c,escapeListener:function(o){o.key==="Escape"&&[].slice.call(document.querySelectorAll(`${V}[data-${D}]`)).reverse()[0]===r.root&&M(r,g(l({},a),{isIgnoreLockDuration:!0}))},clickTouchLayerListener:function(o){o.target===c&&(o.stopPropagation(),u||O(r,1,a))},clickToggleListener:function(o){o.preventDefault(),o.stopPropagation(),O(r,void 0,a)}};return r},se=e=>{let{toggle:t,clickToggleListener:n}=e;t&&t.dataset.registered!==""&&(t.addEventListener("click",n),t.dataset.registered="")},ae=e=>{let{clickTouchLayerListener:t,touchLayer:n}=e;n&&n.dataset.registered!==""&&(n.addEventListener("click",t),n.dataset.registered="")};async function L(e,t,n,a){e.options=l(l({},e.options),n);let s=ne(e,e.el,t,e.options);if(s===void 0)return;e.el||(e.el=s==null?void 0:s.root),se(s),ae(s);let{root:i,isDetails:d}=s;d&&i.getAttribute("open")!==null&&a!==1&&H(s,e.options),a!==void 0&&await O(s,a,e.options)}var oe={_cache:{},mounted(){},beforeUpdate(){var e,t;F(this._cache,(e=this.el)==null?void 0:e.id,(t=this.el)==null?void 0:t.dataset)},updated(){var t,n;let e=k(this._cache,(t=this.el)==null?void 0:t.id);N(e,this.el),b(this._cache,(n=this.el)==null?void 0:n.id)},destroyed(){var e;b(this._cache,(e=this.el)==null?void 0:e.id)},status:y,async init(e,t){await L(this,e,t)},async toggle(e,t){await L(this,e,t,2)},async show(e,t){await L(this,e,t,0)},async hide(e,t){await L(this,e,t,1)}};typeof window<"u"&&(window.Prompt=oe);})();
